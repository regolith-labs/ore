/**
 * This code was AUTOGENERATED using the Codama library.
 * Please DO NOT EDIT THIS FILE, instead use visitors
 * to add features, then rerun Codama to update it.
 *
 * @see https://github.com/codama-idl/codama
 */

import {
  combineCodec,
  getStructDecoder,
  getStructEncoder,
  getU8Decoder,
  getU8Encoder,
  transformEncoder,
  type AccountMeta,
  type AccountSignerMeta,
  type Address,
  type FixedSizeCodec,
  type FixedSizeDecoder,
  type FixedSizeEncoder,
  type Instruction,
  type InstructionWithAccounts,
  type InstructionWithData,
  type ReadonlyAccount,
  type ReadonlyUint8Array,
  type TransactionSigner,
  type WritableAccount,
  type WritableSignerAccount,
} from "@solana/kit";
import { ORE_PROGRAM_ADDRESS } from "../programs";
import { getAccountMetaFactory, type ResolvedAccount } from "../shared";

export const RESET_DISCRIMINATOR = 9;

export function getResetDiscriminatorBytes() {
  return getU8Encoder().encode(RESET_DISCRIMINATOR);
}

export type ResetInstruction<
  TProgram extends string = typeof ORE_PROGRAM_ADDRESS,
  TAccountSigner extends string | AccountMeta<string> = string,
  TAccountBoard extends string | AccountMeta<string> = string,
  TAccountConfig extends string | AccountMeta<string> = string,
  TAccountFeeCollector extends string | AccountMeta<string> = string,
  TAccountMint extends string | AccountMeta<string> = string,
  TAccountRound extends string | AccountMeta<string> = string,
  TAccountRoundNext extends string | AccountMeta<string> = string,
  TAccountTopMiner extends string | AccountMeta<string> = string,
  TAccountTreasury extends string | AccountMeta<string> = string,
  TAccountTreasuryTokens extends string | AccountMeta<string> = string,
  TAccountSystemProgram extends string | AccountMeta<string> =
    "11111111111111111111111111111111",
  TAccountTokenProgram extends string | AccountMeta<string> =
    "TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",
  TAccountOreProgram extends string | AccountMeta<string> = string,
  TAccountSlotHashesSysvar extends string | AccountMeta<string> =
    "SysvarS1otHashes111111111111111111111111111",
  TAccountEntropyVar extends string | AccountMeta<string> = string,
  TAccountEntropyProgram extends string | AccountMeta<string> = string,
  TRemainingAccounts extends readonly AccountMeta<string>[] = [],
> = Instruction<TProgram> &
  InstructionWithData<ReadonlyUint8Array> &
  InstructionWithAccounts<
    [
      TAccountSigner extends string
        ? WritableSignerAccount<TAccountSigner> &
            AccountSignerMeta<TAccountSigner>
        : TAccountSigner,
      TAccountBoard extends string
        ? WritableAccount<TAccountBoard>
        : TAccountBoard,
      TAccountConfig extends string
        ? ReadonlyAccount<TAccountConfig>
        : TAccountConfig,
      TAccountFeeCollector extends string
        ? WritableAccount<TAccountFeeCollector>
        : TAccountFeeCollector,
      TAccountMint extends string
        ? WritableAccount<TAccountMint>
        : TAccountMint,
      TAccountRound extends string
        ? WritableAccount<TAccountRound>
        : TAccountRound,
      TAccountRoundNext extends string
        ? WritableAccount<TAccountRoundNext>
        : TAccountRoundNext,
      TAccountTopMiner extends string
        ? ReadonlyAccount<TAccountTopMiner>
        : TAccountTopMiner,
      TAccountTreasury extends string
        ? WritableAccount<TAccountTreasury>
        : TAccountTreasury,
      TAccountTreasuryTokens extends string
        ? WritableAccount<TAccountTreasuryTokens>
        : TAccountTreasuryTokens,
      TAccountSystemProgram extends string
        ? ReadonlyAccount<TAccountSystemProgram>
        : TAccountSystemProgram,
      TAccountTokenProgram extends string
        ? ReadonlyAccount<TAccountTokenProgram>
        : TAccountTokenProgram,
      TAccountOreProgram extends string
        ? ReadonlyAccount<TAccountOreProgram>
        : TAccountOreProgram,
      TAccountSlotHashesSysvar extends string
        ? ReadonlyAccount<TAccountSlotHashesSysvar>
        : TAccountSlotHashesSysvar,
      TAccountEntropyVar extends string
        ? ReadonlyAccount<TAccountEntropyVar>
        : TAccountEntropyVar,
      TAccountEntropyProgram extends string
        ? ReadonlyAccount<TAccountEntropyProgram>
        : TAccountEntropyProgram,
      ...TRemainingAccounts,
    ]
  >;

export type ResetInstructionData = { discriminator: number };

export type ResetInstructionDataArgs = {};

export function getResetInstructionDataEncoder(): FixedSizeEncoder<ResetInstructionDataArgs> {
  return transformEncoder(
    getStructEncoder([["discriminator", getU8Encoder()]]),
    (value) => ({ ...value, discriminator: RESET_DISCRIMINATOR }),
  );
}

export function getResetInstructionDataDecoder(): FixedSizeDecoder<ResetInstructionData> {
  return getStructDecoder([["discriminator", getU8Decoder()]]);
}

export function getResetInstructionDataCodec(): FixedSizeCodec<
  ResetInstructionDataArgs,
  ResetInstructionData
> {
  return combineCodec(
    getResetInstructionDataEncoder(),
    getResetInstructionDataDecoder(),
  );
}

export type ResetInput<
  TAccountSigner extends string = string,
  TAccountBoard extends string = string,
  TAccountConfig extends string = string,
  TAccountFeeCollector extends string = string,
  TAccountMint extends string = string,
  TAccountRound extends string = string,
  TAccountRoundNext extends string = string,
  TAccountTopMiner extends string = string,
  TAccountTreasury extends string = string,
  TAccountTreasuryTokens extends string = string,
  TAccountSystemProgram extends string = string,
  TAccountTokenProgram extends string = string,
  TAccountOreProgram extends string = string,
  TAccountSlotHashesSysvar extends string = string,
  TAccountEntropyVar extends string = string,
  TAccountEntropyProgram extends string = string,
> = {
  signer: TransactionSigner<TAccountSigner>;
  board: Address<TAccountBoard>;
  config: Address<TAccountConfig>;
  feeCollector: Address<TAccountFeeCollector>;
  mint: Address<TAccountMint>;
  round: Address<TAccountRound>;
  roundNext: Address<TAccountRoundNext>;
  topMiner: Address<TAccountTopMiner>;
  treasury: Address<TAccountTreasury>;
  treasuryTokens: Address<TAccountTreasuryTokens>;
  systemProgram?: Address<TAccountSystemProgram>;
  tokenProgram?: Address<TAccountTokenProgram>;
  oreProgram: Address<TAccountOreProgram>;
  slotHashesSysvar?: Address<TAccountSlotHashesSysvar>;
  entropyVar: Address<TAccountEntropyVar>;
  entropyProgram: Address<TAccountEntropyProgram>;
};

export function getResetInstruction<
  TAccountSigner extends string,
  TAccountBoard extends string,
  TAccountConfig extends string,
  TAccountFeeCollector extends string,
  TAccountMint extends string,
  TAccountRound extends string,
  TAccountRoundNext extends string,
  TAccountTopMiner extends string,
  TAccountTreasury extends string,
  TAccountTreasuryTokens extends string,
  TAccountSystemProgram extends string,
  TAccountTokenProgram extends string,
  TAccountOreProgram extends string,
  TAccountSlotHashesSysvar extends string,
  TAccountEntropyVar extends string,
  TAccountEntropyProgram extends string,
  TProgramAddress extends Address = typeof ORE_PROGRAM_ADDRESS,
>(
  input: ResetInput<
    TAccountSigner,
    TAccountBoard,
    TAccountConfig,
    TAccountFeeCollector,
    TAccountMint,
    TAccountRound,
    TAccountRoundNext,
    TAccountTopMiner,
    TAccountTreasury,
    TAccountTreasuryTokens,
    TAccountSystemProgram,
    TAccountTokenProgram,
    TAccountOreProgram,
    TAccountSlotHashesSysvar,
    TAccountEntropyVar,
    TAccountEntropyProgram
  >,
  config?: { programAddress?: TProgramAddress },
): ResetInstruction<
  TProgramAddress,
  TAccountSigner,
  TAccountBoard,
  TAccountConfig,
  TAccountFeeCollector,
  TAccountMint,
  TAccountRound,
  TAccountRoundNext,
  TAccountTopMiner,
  TAccountTreasury,
  TAccountTreasuryTokens,
  TAccountSystemProgram,
  TAccountTokenProgram,
  TAccountOreProgram,
  TAccountSlotHashesSysvar,
  TAccountEntropyVar,
  TAccountEntropyProgram
> {
  // Program address.
  const programAddress = config?.programAddress ?? ORE_PROGRAM_ADDRESS;

  // Original accounts.
  const originalAccounts = {
    signer: { value: input.signer ?? null, isWritable: true },
    board: { value: input.board ?? null, isWritable: true },
    config: { value: input.config ?? null, isWritable: false },
    feeCollector: { value: input.feeCollector ?? null, isWritable: true },
    mint: { value: input.mint ?? null, isWritable: true },
    round: { value: input.round ?? null, isWritable: true },
    roundNext: { value: input.roundNext ?? null, isWritable: true },
    topMiner: { value: input.topMiner ?? null, isWritable: false },
    treasury: { value: input.treasury ?? null, isWritable: true },
    treasuryTokens: { value: input.treasuryTokens ?? null, isWritable: true },
    systemProgram: { value: input.systemProgram ?? null, isWritable: false },
    tokenProgram: { value: input.tokenProgram ?? null, isWritable: false },
    oreProgram: { value: input.oreProgram ?? null, isWritable: false },
    slotHashesSysvar: {
      value: input.slotHashesSysvar ?? null,
      isWritable: false,
    },
    entropyVar: { value: input.entropyVar ?? null, isWritable: false },
    entropyProgram: { value: input.entropyProgram ?? null, isWritable: false },
  };
  const accounts = originalAccounts as Record<
    keyof typeof originalAccounts,
    ResolvedAccount
  >;

  // Resolve default values.
  if (!accounts.systemProgram.value) {
    accounts.systemProgram.value =
      "11111111111111111111111111111111" as Address<"11111111111111111111111111111111">;
  }
  if (!accounts.tokenProgram.value) {
    accounts.tokenProgram.value =
      "TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA" as Address<"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA">;
  }
  if (!accounts.slotHashesSysvar.value) {
    accounts.slotHashesSysvar.value =
      "SysvarS1otHashes111111111111111111111111111" as Address<"SysvarS1otHashes111111111111111111111111111">;
  }

  const getAccountMeta = getAccountMetaFactory(programAddress, "programId");
  return Object.freeze({
    accounts: [
      getAccountMeta(accounts.signer),
      getAccountMeta(accounts.board),
      getAccountMeta(accounts.config),
      getAccountMeta(accounts.feeCollector),
      getAccountMeta(accounts.mint),
      getAccountMeta(accounts.round),
      getAccountMeta(accounts.roundNext),
      getAccountMeta(accounts.topMiner),
      getAccountMeta(accounts.treasury),
      getAccountMeta(accounts.treasuryTokens),
      getAccountMeta(accounts.systemProgram),
      getAccountMeta(accounts.tokenProgram),
      getAccountMeta(accounts.oreProgram),
      getAccountMeta(accounts.slotHashesSysvar),
      getAccountMeta(accounts.entropyVar),
      getAccountMeta(accounts.entropyProgram),
    ],
    data: getResetInstructionDataEncoder().encode({}),
    programAddress,
  } as ResetInstruction<
    TProgramAddress,
    TAccountSigner,
    TAccountBoard,
    TAccountConfig,
    TAccountFeeCollector,
    TAccountMint,
    TAccountRound,
    TAccountRoundNext,
    TAccountTopMiner,
    TAccountTreasury,
    TAccountTreasuryTokens,
    TAccountSystemProgram,
    TAccountTokenProgram,
    TAccountOreProgram,
    TAccountSlotHashesSysvar,
    TAccountEntropyVar,
    TAccountEntropyProgram
  >);
}

export type ParsedResetInstruction<
  TProgram extends string = typeof ORE_PROGRAM_ADDRESS,
  TAccountMetas extends readonly AccountMeta[] = readonly AccountMeta[],
> = {
  programAddress: Address<TProgram>;
  accounts: {
    signer: TAccountMetas[0];
    board: TAccountMetas[1];
    config: TAccountMetas[2];
    feeCollector: TAccountMetas[3];
    mint: TAccountMetas[4];
    round: TAccountMetas[5];
    roundNext: TAccountMetas[6];
    topMiner: TAccountMetas[7];
    treasury: TAccountMetas[8];
    treasuryTokens: TAccountMetas[9];
    systemProgram: TAccountMetas[10];
    tokenProgram: TAccountMetas[11];
    oreProgram: TAccountMetas[12];
    slotHashesSysvar: TAccountMetas[13];
    entropyVar: TAccountMetas[14];
    entropyProgram: TAccountMetas[15];
  };
  data: ResetInstructionData;
};

export function parseResetInstruction<
  TProgram extends string,
  TAccountMetas extends readonly AccountMeta[],
>(
  instruction: Instruction<TProgram> &
    InstructionWithAccounts<TAccountMetas> &
    InstructionWithData<ReadonlyUint8Array>,
): ParsedResetInstruction<TProgram, TAccountMetas> {
  if (instruction.accounts.length < 16) {
    // TODO: Coded error.
    throw new Error("Not enough accounts");
  }
  let accountIndex = 0;
  const getNextAccount = () => {
    const accountMeta = (instruction.accounts as TAccountMetas)[accountIndex]!;
    accountIndex += 1;
    return accountMeta;
  };
  return {
    programAddress: instruction.programAddress,
    accounts: {
      signer: getNextAccount(),
      board: getNextAccount(),
      config: getNextAccount(),
      feeCollector: getNextAccount(),
      mint: getNextAccount(),
      round: getNextAccount(),
      roundNext: getNextAccount(),
      topMiner: getNextAccount(),
      treasury: getNextAccount(),
      treasuryTokens: getNextAccount(),
      systemProgram: getNextAccount(),
      tokenProgram: getNextAccount(),
      oreProgram: getNextAccount(),
      slotHashesSysvar: getNextAccount(),
      entropyVar: getNextAccount(),
      entropyProgram: getNextAccount(),
    },
    data: getResetInstructionDataDecoder().decode(instruction.data),
  };
}
